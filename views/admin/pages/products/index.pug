extends ../../layouts/default.pug
include ../../mixins/filterStatus.pug
include ../../mixins/search.pug
include ../../mixins/pagination.pug
include ../../mixins/formChangeMulti.pug
block main
  h1 Danh sách sản phẩm

  .card.mb-3 
    .card-header Bộ lọc và tìm kiếm
      .card-body 
        .row 
          .col-6
            .btn-group
              +filterStatus(buttonStatus)
          .col-6 
            +search(keyword)
  
  .card.mb-3 
    .card-header Danh sách sản phẩm
      .card-body 
        +formChangeMulti(`${prefixAdmin}/products/change-multi?_method=PATCH`)
        table(
          class = 'table table-hover table-sm'
          checkbox-multi
        )
          thead
            tr
              th 
                input(
                  type='checkbox'
                  class='form-check-input'
                  name="checkAll"
                )
              th STT
              th Hình ảnh
              th Tiêu đề
              th Giá
              th Vị trí
              th Trạng thái
              th Hành động
          tbody
              each product, index in products
                tr
                  td 
                    input(
                      type='checkbox'
                      class='form-check-input'
                      name='ids'
                      value=product._id
                    )
                  td #{index + 1 + (pagination.currentPage - 1) * pagination.limitItems}
                  td
                      img(
                          src=product.thumbnail,
                          alt=product.title,
                          width="100px",
                          height="auto"
                      )
                  td #{product.title}
                  td #{product.price}$
                  td 
                    input(
                      type='number'
                      value=product.position
                      class='form-control form-control-sm'
                      style='width: 50px;'
                      name='position'
                      min=1
                    )
                  td
                      if product.status === 'active'
                          a(href="javascript:;"
                            class="badge text-bg-success rounded-pill"
                            data-status="active"
                            data-id=product._id
                            button-change-status 
                           ) Hoạt động
                      else
                          a(href="javascript:;"
                          class="badge text-bg-danger rounded-pill"
                          data-status="inactive"
                          data-id=product._id
                          button-change-status 
                          ) Dừng hoạt động
                  td
                      button(type="button", class="btn btn-warning btn-sm") Sửa
                      button(
                        type="button"
                        class="btn btn-danger btn-sm ms-1"
                        button-delete
                        data-id=product._id
                      ) Xóa
  +pagination(pagination)
  form(
    id='form-change-status'
    action=``
    method='POST'
    data-path=`${prefixAdmin}/products/change-status`
  )
  form(
    id='form-delete-product'
    action=``
    method='POST'
    data-path=`${prefixAdmin}/products/delete-product`
  )
  script(src="/admin/js/product.js") 